import{R as w,r as C,j as e}from"./app-CZojdjD4.js";import{D as F}from"./dialog.esm-BRb5edDq.js";import{I as g}from"./inputtext.esm-Bc9dGI99.js";import{u as S}from"./formik.esm-C2ZluvBh.js";import{D as b}from"./dropdown.esm-C3w7lM7_.js";import{I as R}from"./inputnumber.esm-BkIM76z1.js";import{C as c}from"./checkbox.esm-B-mc0jlu.js";import{D as y}from"./divider.esm-BSiOJ7Q4.js";import{B as u}from"./button.esm-Cv2vqUD6.js";import{A as I,a as H}from"./accordion.esm-BkzqJAze.js";import{I as z}from"./image.esm-BxHawxpu.js";import"./iconbase.esm-DvODm2qg.js";import"./csstransition.esm-BI2IUjb-.js";import"./ripple.esm-ByfALGiA.js";import"./virtualscroller.esm-aVvJseNT.js";import"./overlayservice.esm-0R6tr4hB.js";import"./index.esm-BypTRDCm.js";import"./index.esm-Bh2Rs3JK.js";const M=({csrf_token:j,visible:v,setVisible:m,categories:d,onChange:N=()=>{},products:_,toast:t})=>{var x;const p=w.createRef(),[l,h]=C.useState(!1),{values:s,handleChange:f,setFieldValue:a}=S({initialValues:{preorder:!1,order:0,sku:"",name:"",category:(x=d[0])==null?void 0:x.name,price:1,is_new:!1,is_discount:!1,is_tl:!0,is_active:!0,selectedCategory:d[0],selectedProduct:null,images:[]}}),k=()=>{if(s.sku.length===0){t.current.show({severity:"error",summary:"Hata",detail:"Stok Kodu Zorunludur!"});return}if(s.name.length===0){t.current.show({severity:"error",summary:"Hata",detail:"Ürün Adı Zorunludur!"});return}if(s.category.length===0){t.current.show({severity:"error",summary:"Hata",detail:"Kategori Zorunludur!"});return}if(s.price<=0){t.current.show({severity:"error",summary:"Hata",detail:"Fiyat 0 dan büyük olmalıdır!"});return}if(s.images.length===0){t.current.show({severity:"error",summary:"Hata",detail:"En Az Bir Resim Seçmelisiniz!"});return}if(s.preorder&&!s.selectedProduct){t.current.show({severity:"error",summary:"Hata",detail:"Önceden Sıralanacak Ürünü Seçmelisiniz!"});return}h(!0);let r=new FormData;r.append("sku",s.sku),r.append("name",s.name),r.append("category",s.category),r.append("price",s.price),r.append("is_new",s.is_new?1:0),r.append("is_discount",s.is_discount?1:0),r.append("is_tl",s.is_tl?1:0),r.append("is_active",s.is_active?1:0),s.preorder&&r.append("order",s.order),s.images.forEach((i,n)=>{r.append("images["+n+"]",i)}),fetch(route("products.store"),{method:"POST",headers:{"X-CSRF-TOKEN":j},body:r}).then(i=>i.json()).then(i=>{var n;i.status?(t.current.show({severity:"success",summary:"Başarılı",detail:i.message}),a("sku",""),a("name",""),a("category",(n=d[0])==null?void 0:n.name),a("price",1),a("is_new",!1),a("is_discount",!1),a("is_tl",!0),a("is_active",!0),a("images",[]),a("selectedCategory",d[0]),a("selectedProduct",null),N(i.products),m(!1)):t.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{t.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{h(!1)})};return e.jsx(e.Fragment,{children:e.jsx(F,{header:"Yeni Ürün Ekle",maximizable:!0,visible:v,style:{width:"50vw"},onHide:()=>m(!1),footer:e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Kapat",icon:"pi pi-times",size:"small",loading:l,severity:"secondary",onClick:()=>m(!1)}),e.jsx(u,{label:"Kaydet",icon:"pi pi-save",size:"small",loading:l,className:"p-button-success",onClick:k})]}),children:e.jsxs("div",{className:"p-fluid",children:[e.jsxs("div",{className:"mb-3 flex items-center",children:[e.jsx(c,{inputId:"preorder",disabled:l,name:"preorder",onChange:r=>{a("preorder",r.checked)},checked:s.preorder}),e.jsx("label",{htmlFor:"preorder",className:"ml-3 font-bold",children:"Ürünü Önceden Sırala"})]}),s.preorder&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"preorderProducts",className:"font-bold",children:["Hangi Ürünün Altına Koymak İstediğinizi Seçiniz ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(b,{disabled:l,inputId:"preorderProducts",options:_,optionLabel:"name",value:s.selectedProduct,filter:!0,showClear:!1,onChange:r=>{a("order",r.value.order),a("selectedProduct",r.value)}})]}),e.jsx(y,{}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Ürün Stok Kodu ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(g,{disabled:l,id:"email",type:"text",name:"sku",onChange:f,value:s.sku})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Ürün Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(g,{disabled:l,id:"name",type:"text",name:"name",onChange:f,value:s.name})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:" ",className:"font-bold",children:["Ürün Kategorisi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(b,{disabled:l,inputId:"category",options:d,optionLabel:"name",value:s.selectedCategory,filter:!0,showClear:!1,onChange:r=>{a("category",r.value.name),a("selectedCategory",r.value)}})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"price",className:"font-bold",children:["Ürün Fiyatı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(R,{disabled:l,inputId:"price",name:"price",mode:"currency",currency:s.is_tl?"TRY":"USD",min:0,onChange:r=>{a("price",r.value)},value:s.price})]}),e.jsxs("div",{className:"mb-3 flex items-center",children:[e.jsx(c,{disabled:l,inputId:"is_tl",name:"is_tl",onChange:r=>{a("is_tl",r.checked)},checked:s.is_tl}),e.jsxs("label",{htmlFor:"is_tl",className:"ml-3 font-bold",children:["TL Fiyat ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]})]}),e.jsxs("div",{className:"mb-3 flex items-center",children:[e.jsx(c,{disabled:l,inputId:"is_new",name:"is_new",onChange:r=>{a("is_new",r.checked)},checked:s.is_new}),e.jsxs("label",{htmlFor:"is_new",className:"ml-3 font-bold",children:["Yeni Ürün ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]})]}),e.jsxs("div",{className:"mb-3 flex items-center",children:[e.jsx(c,{disabled:l,inputId:"is_discount",name:"is_discount",onChange:r=>{a("is_discount",r.checked)},checked:s.is_discount}),e.jsxs("label",{htmlFor:"is_discount",className:"ml-3 font-bold",children:["İndirimli Ürün ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]})]}),e.jsx(y,{}),e.jsxs("div",{className:"mb-3",children:[e.jsx(u,{disabled:l,label:s.images.length>0?`${s.images.length} Adet Resim Seçili`:"Ürün Resimlerini Seçin",icon:"pi pi-image",type:"button",severity:s.images.length>0?"success":"info",onClick:()=>{p.current.click()}}),e.jsx("input",{type:"file",name:"files",id:"files",onChange:r=>{let i=r.target.files,n=[];for(let o=0;o<i.length;o++)i[o].type.includes("image")&&n.push(i[o]);n.length===0&&t.current.show({severity:"warn",summary:"Hata",detail:"Lütfen Sadece Resim Veya Video Dosyaları Seçiniz."}),a("images",n)},accept:"image/*,video/*",style:{display:"none"},multiple:!0,ref:p})]}),e.jsx(I,{className:"mb-3",hidden:!s.images.length>0,children:e.jsx(H,{header:"Seçili Resimler ("+s.images.length+")",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 lg:grid-cols-3",children:s.images.map((r,i)=>e.jsx(z,{src:URL.createObjectURL(r),alt:"Resim",preview:!0,className:"w-full h-full"},i))})})})]})})})};export{M as default};
