import{r as l,j as t,y as K,a as H,F as f}from"./app-MMx-yB3G.js";import{M as B}from"./MessageDialog-CK2qbNEd.js";import{A as G}from"./AuthenticatedLayout-DqJQv-Zq.js";import{T as D}from"./toolbar.esm-Ck1JAFVg.js";import{B as y}from"./button.esm-t3q6Uns9.js";import{D as Y,C as d}from"./column.esm-BSKXtLdH.js";import{c as U}from"./confirmpopup.esm-bTiZjuf1.js";import{T as _}from"./toast.esm-Cjq_L-3x.js";import{D as R}from"./dropdown.esm-BzwAhd2S.js";import{I as E}from"./inputswitch.esm-cXlWa7FN.js";import X from"./Images-CvthB9HY.js";import $ from"./Categories-DAURezxn.js";import Q from"./Create-OqkpWIaa.js";import J from"./Update-D0lPpzK5.js";import q from"./ImageGenerator-3LHfoE40.js";import{I as W}from"./inputnumber.esm-JaxKPWvd.js";import{I as N}from"./inputtext.esm-BmSpreyY.js";import{f as Z}from"./helper-5dsdU7t8.js";import"./dialog.esm-BnJITAjQ.js";import"./iconbase.esm-48fxaLvN.js";import"./csstransition.esm-C7-qQLFH.js";import"./ripple.esm-CDHzLfkq.js";import"./inputtextarea.esm-c6Gr0vxJ.js";import"./useSmsCounter-COrV3HUj.js";import"./blockui.esm-CvrtRqj0.js";import"./accordion.esm-Bxv35aXX.js";import"./virtualscroller.esm-Cs74YQWK.js";import"./index.esm-Bu_OTDB3.js";import"./ApplicationLogo-7IUcid-B.js";import"./transition-Chc5_UKz.js";import"./index.esm-B6m0rV8L.js";import"./overlayservice.esm-BwHVid_d.js";import"./index.esm-6wxOW2yc.js";import"./index.esm-vUqAtpS5.js";import"./TransitionGroup-CAdOuic2.js";import"./image.esm-i4QklBz_.js";import"./progressbar.esm-Dh5NOXj8.js";import"./formik.esm-DiYpwH7p.js";import"./checkbox.esm-CXXwiJ4o.js";import"./divider.esm-eF0Oq9Lz.js";import"./html2canvas.esm-Chigv41t.js";const Be=({auth:x,csrf_token:n,categories:c})=>{const[h,m]=l.useState([]),[C,j]=l.useState(!1);l.useState(!1);const s=l.useRef(null),[S,p]=l.useState(!0),[b,v]=l.useState(null),[z,k]=l.useState(!1),[M,w]=l.useState(!1),[P,V]=l.useState(c),[L,T]=l.useState(!1),[A,F]=l.useState(!1),[I,O]=l.useState(!1);l.useEffect(()=>{Z(n).then(e=>{e.status?m(e.data):s.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).catch(e=>{console.log(e),s.current.show({severity:"error",summary:"Hata",detail:"Ürünler yüklenirken bir hata oluştu."})}).finally(()=>p(!1))},[]);const g=({rowData:e,field:r,newValue:a})=>{if(e[r]===a){s.current.show({severity:"info",summary:"Uyarı",detail:"Değişiklik Olmadı"});return}let i=e.id;e={...e,[r]:a},p(!0);let o=new FormData;o.append("sku",e.sku),o.append("name",e.name),o.append("category",e.category),o.append("price",e.price),o.append("is_new",e.is_new?1:0),o.append("is_discount",e.is_discount?1:0),o.append("is_tl",e.is_tl?1:0),o.append("is_active",e.is_active?1:0),o.append("order",e.order),o.append("_method","PUT"),fetch(route("products.update",i),{method:"POST",headers:{"X-CSRF-TOKEN":n},body:o}).then(u=>u.json()).then(u=>{u.status?(s.current.show({severity:"success",summary:"Başarılı",detail:u.message}),m(u.products)):s.current.show({severity:"error",summary:"Hata",detail:u.message})}).catch(u=>{s.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{p(!1)})};return t.jsx(t.Fragment,{children:t.jsxs(G,{user:x.user,header:"Ürünler",info:[{icon:"pi-box",text:`${h.length} adet ürün bulunmaktadır.`},{icon:"pi-check",text:`${h.map(e=>e.is_active===1?!0:null).filter(Boolean).length} adet aktif ürün bulunmaktadır.`},{icon:"pi-times",text:`${h.map(e=>e.is_active===0?!0:null).filter(Boolean).length} adet pasif ürün bulunmaktadır.`}],buttons:[{icon:"pi pi-plus",tooltip:"Yeni Ürün Ekle",severity:"success",tooltipOptions:{position:"bottom"},size:"small",onClick:()=>{T(!0)}},{icon:"pi pi-users",tooltip:"Müşterileri Görüntüle",tooltipOptions:{position:"bottom"},size:"small",severity:"info",onClick:()=>{K.visit(route("customers.index"))}},{icon:"pi pi-send",tooltip:"Yeni Mesaj Gönder",severity:"warning",tooltipOptions:{position:"bottom"},size:"small",onClick:()=>{j(!C)}}],children:[t.jsx(_,{ref:s}),t.jsx(H,{title:"Ürünler"}),t.jsx("div",{className:"py-6",children:t.jsx("div",{className:"max-w-[90rem] mx-auto sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:t.jsxs(Y,{value:h,removableSort:!0,paginator:!0,stripedRows:!0,editMode:"cell",reorderableRows:!0,onRowReorder:e=>{let r=e.value.map(({id:i},o)=>({id:i,sort:o+1}));m(e.value);let a=new FormData;a.append("data",JSON.stringify(r)),p(!0),fetch(route("products.updateOrder"),{method:"POST",headers:{"X-CSRF-TOKEN":n},body:a}).then(i=>i.json()).then(i=>{i.status?(s.current.show({severity:"success",summary:"Başarılı",detail:i.message}),m(i.products)):s.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{s.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{p(!1)})},filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",filters:{name:{value:null,matchMode:f.CONTAINS},sku:{value:null,matchMode:f.CONTAINS},category:{value:null,matchMode:f.EQUALS},price:{value:null,matchMode:f.CONTAINS},is_active:{value:null,matchMode:f.EQUALS}},loading:S,header:t.jsx(t.Fragment,{children:t.jsx(D,{end:()=>t.jsx(t.Fragment,{children:t.jsx(y,{icon:"pi pi-bars",severity:"info",tooltip:"Bu Ekrandan Kategorileri Yönetebilirsiniz.",tooltipOptions:{position:"top"},label:"Kategoriler",onClick:()=>{w(!0)}})})})}),emptyMessage:"Ürün bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",children:[t.jsx(d,{rowReorder:!0,style:{width:"3rem"}}),t.jsx(d,{field:"order",sortable:!0,header:"#"}),t.jsx(d,{field:"is_active",style:{width:"3rem"},header:"Aktif",body:e=>t.jsx(E,{checked:!!e.is_active,onChange:({value:r})=>{p(!0);let a=new FormData;a.append("is_active",r===!0?1:0),fetch(route("products.updateIsActive",e.id),{method:"POST",headers:{"X-CSRF-TOKEN":n},body:a}).then(i=>i.json()).then(i=>{i.status?(s.current.show({severity:"success",summary:"Başarılı",detail:i.message}),m(o=>o.map(u=>(u.id===e.id&&(u.is_active=r===!0?1:0),u)))):s.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{s.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{p(!1)})}}),filter:!0,showFilterMenu:!1,filterElement:e=>t.jsx(E,{checked:e.value===1,onChange:({value:r})=>{e.filterApplyCallback(r===!0?1:0)}})}),t.jsx(d,{field:"sku",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Koduna Göre",onCellEditComplete:e=>g(e),editor:e=>t.jsx(N,{type:"text",value:e.value,onChange:r=>e.editorCallback(r.target.value),onKeyDown:r=>r.stopPropagation()}),sortable:!0,header:"Ürün Kodu"}),t.jsx(d,{field:"name",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Adına Göre",sortable:!0,header:"Ürün Adı",onCellEditComplete:e=>g(e),editor:e=>t.jsx(N,{type:"text",value:e.value,onChange:r=>e.editorCallback(r.target.value),onKeyDown:r=>r.stopPropagation()})}),t.jsx(d,{field:"category",filter:!0,showFilterMenu:!1,filterPlaceholder:"Kategoriye Göre",sortable:!0,onCellEditComplete:e=>g(e),editor:e=>t.jsx(R,{options:c,onChange:r=>e.editorCallback(r.value.name),placeholder:"Kategori Seçiniz",optionLabel:"name",value:c.find(r=>r.name===e.value)}),header:"Kategori",filterElement:e=>t.jsx(R,{options:c,onChange:r=>e.filterApplyCallback(r.value.name),placeholder:"Kategori Seçiniz",optionLabel:"name",value:c.find(r=>r.name===e.value)})}),t.jsx(d,{field:"price",filter:!0,showFilterMenu:!1,filterPlaceholder:"Ürün Fiyatına Göre",editor:e=>t.jsx(W,{placeholder:"Ürün Fiyatı",mode:"currency",disabled:S,onChange:r=>e.editorCallback(r.value),value:e.value,currency:e.rowData.is_tl===1?"TRY":"USD"}),sortable:!0,header:"Ürün Fiyatı",body:({price:e,is_tl:r})=>t.jsxs("span",{className:"p-tag text-md"+(r?" p-tag-success":" p-tag-info"),children:[e," ",r?"₺":"$"]}),onCellEditComplete:e=>{g(e)}}),t.jsx(d,{header:"İşlemler",body:e=>t.jsxs("div",{className:"flex justify-center gap-x-2",children:[t.jsx(y,{icon:"pi pi-cloud-download",size:"small",tooltip:"Kampanya Resmi İndir",tooltipOptions:{position:"top"},severity:"warning",onClick:()=>{v(e),O(!0)}}),t.jsx(y,{icon:"pi pi-images",size:"small",tooltip:"Resimleri Görüntüle",tooltipOptions:{position:"top"},severity:"help",onClick:()=>{v(e),k(!0)}}),t.jsx(y,{icon:"pi pi-pencil",size:"small",tooltip:"Ürünü Düzenle",tooltipOptions:{position:"top"},severity:"info",onClick:()=>{v(e),F(!0)}}),t.jsx(y,{icon:"pi pi-trash",size:"small",tooltip:"Ürünü Sil",tooltipOptions:{position:"top"},severity:"danger",onClick:r=>U({target:r.currentTarget,message:"Ürünü silmek istediğinize emin misiniz?",icon:"pi pi-exclamation-triangle",acceptClassName:"p-button-danger",acceptLabel:"Sil",rejectLabel:"Vazgeç",accept:()=>{p(!0),fetch(route("products.destroy",e.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":n}}).then(a=>a.json()).then(a=>{a.status?(s.current.show({severity:"success",summary:"Başarılı",detail:a.message}),m(a.products)):s.current.show({severity:"error",summary:"Hata",detail:a.message})}).catch(a=>{s.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{p(!1)})}})})]})})]})})})}),t.jsx(q,{csrf_token:n,product:b,visible:I,setVisible:O,toast:s}),t.jsx(J,{csrf_token:n,visible:A,products:h.map(({id:e,order:r,name:a,sku:i})=>({id:e,order:r,name:(i+" - "+a).substring(0,70)})),setVisible:F,toast:s,categories:P,onChange:e=>{m(e)},product:b}),t.jsx(Q,{csrf_token:n,visible:L,products:h.map(({id:e,order:r,name:a,sku:i})=>({id:e,order:r,name:(i+" - "+a).substring(0,70)})),setVisible:T,toast:s,categories:P,onChange:e=>{m(e)}}),t.jsx($,{csrf_token:n,toast:s,visible:M,categoriesAll:c,setVisible:w,onChange:e=>V(e)}),t.jsx(X,{product:b,visible:z,setVisible:k,toast:s,csrf_token:n}),t.jsx(B,{csrf_token:n,visible:C,setVisible:j,auth:x})]})})};export{Be as default};
