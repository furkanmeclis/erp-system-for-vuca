import{r as l,j as e,y as c,Y as y,F as u}from"./app-CZojdjD4.js";import{A as v}from"./AuthenticatedLayout-B_5TWh4u.js";import{D as M,C as h}from"./column.esm-CXMPILxJ.js";import{B as w}from"./button.esm-Cv2vqUD6.js";import{C,c as P}from"./confirmpopup.esm-CVN6frEl.js";import{T as k}from"./toast.esm-Ci78TIq9.js";import{A as N,a as f}from"./accordion.esm-BkzqJAze.js";import{I as T}from"./inputtextarea.esm-oIyypEZZ.js";import{u as S}from"./useSmsCounter-DY0gdP9E.js";import{B as A}from"./blockui.esm-CT455C9i.js";import"./ApplicationLogo-C3VFVwyk.js";import"./transition-Bl2-vqQL.js";import"./iconbase.esm-DvODm2qg.js";import"./ripple.esm-ByfALGiA.js";import"./inputnumber.esm-BkIM76z1.js";import"./inputtext.esm-Bc9dGI99.js";import"./dropdown.esm-C3w7lM7_.js";import"./virtualscroller.esm-aVvJseNT.js";import"./csstransition.esm-BI2IUjb-.js";import"./overlayservice.esm-0R6tr4hB.js";import"./index.esm-BypTRDCm.js";import"./index.esm-Bh2Rs3JK.js";import"./index.esm-DSWsuiEf.js";import"./index.esm-D-5U2K2D.js";import"./TransitionGroup-_qrsneQI.js";const se=({auth:x,csrf_token:g,group:r})=>{const t=l.useRef(null);l.useState([]);const{message:a,setMessage:n,smsCount:m,charCount:j}=S(),[p,d]=l.useState(!1),b=i=>{if(a.length===0){t.current.show({severity:"warn",summary:"Hata",detail:"Mesaj Boş Olamaz",life:3e3});return}P({target:i.currentTarget,message:`${r.members.length} Müşteriye ${m*r.members.length} SMS Gönderilecek. Onaylıyor musunuz?`,icon:"pi pi-info-circle",acceptClassName:"p-button-success",acceptLabel:"Gönder",rejectLabel:"İptal",accept:()=>{d(!0);let o=new FormData;o.append("message",a),o.append("group",r.id),fetch(route("groups.sendMessage",r.id),{method:"POST",headers:{"X-CSRF-TOKEN":g},body:o}).then(s=>s.json()).then(s=>{s.status?(t.current.show({severity:"success",summary:"Başarılı",detail:s.message}),n("")):t.current.show({severity:"error",summary:"Hata",detail:s.message})}).finally(()=>{d(!1)})}})};return e.jsxs(v,{info:[{icon:"pi-users",text:`Toplam ${r.members.length} Müşteri`}],header:`"${r.name}" Adlı Grup`,user:x.user,buttons:[{size:"small",icon:"pi pi-arrow-left",tooltip:"Geri (Gruplar)",severity:"secondary",tooltipOptions:{position:"bottom"},onClick:()=>{c.visit(route("groups.index"))}},{size:"small",icon:"pi pi-pencil",tooltip:"Grubu Düzenle",severity:"warn",tooltipOptions:{position:"bottom"},onClick:()=>{c.visit(route("groups.edit",r.id))}}],children:[e.jsx(y,{title:`"${r.name}" Adlı Grup`}),e.jsx(k,{ref:t}),e.jsx(C,{}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx(A,{blocked:p,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsx("div",{className:"p-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:e.jsxs(N,{multiple:!0,activeIndex:[0],children:[e.jsx(f,{header:"Mesaj Gönder",children:e.jsxs("div",{className:"p-fluid",children:[e.jsxs("div",{className:"p-field",children:[e.jsxs("label",{htmlFor:"name",children:["Mesaj [",j," Karakter / ",m," SMS]"]}),e.jsx(T,{id:"message",value:a,onChange:i=>n(i.target.value),rows:3,cols:20,autoResize:!0,placeholder:"Mesajınızı Giriniz"})]}),e.jsx("div",{className:"inline-flex",children:e.jsx(w,{label:"Gönder",icon:"pi pi-send",severity:"success",onClick:b,loading:p,size:"small"})})]})}),e.jsx(f,{header:"Grup Üyeleri",children:e.jsxs(M,{value:r.members,filterDisplay:"row",removableSort:!0,paginator:!0,filters:{name:{value:null,matchMode:u.CONTAINS},phone:{value:null,matchMode:u.CONTAINS}},emptyMessage:"Müşteri bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",children:[e.jsx(h,{field:"name",header:"Müşteri Adı",sortable:!0,filter:!0,showFilterMenu:!1,filterPlaceholder:"Müşteri Adına Göre Arama"}),e.jsx(h,{field:"phone",header:"Müşteri Telefon",sortable:!0,filter:!0,showFilterMenu:!1,filterPlaceholder:"Müşteri Telefonuna Göre Arama"})]})})]})})})})})})]})};export{se as default};
