import{r as a,j as e,Y as k,F as o,y as P}from"./app-CZojdjD4.js";import{A as S}from"./AuthenticatedLayout-B_5TWh4u.js";import{D as N,C as i}from"./column.esm-CXMPILxJ.js";import{B as n}from"./button.esm-Cv2vqUD6.js";import{C as F,c as E}from"./confirmpopup.esm-CVN6frEl.js";import{T as L}from"./toolbar.esm-OLcWUjRd.js";import{T as M}from"./toast.esm-Ci78TIq9.js";import{T as K}from"./tag.esm-CzqNWVCB.js";import O from"./Create-7RF_lkoY.js";import R from"./Update-CP0P7t9O.js";import"./ApplicationLogo-C3VFVwyk.js";import"./transition-Bl2-vqQL.js";import"./iconbase.esm-DvODm2qg.js";import"./ripple.esm-ByfALGiA.js";import"./inputnumber.esm-BkIM76z1.js";import"./inputtext.esm-Bc9dGI99.js";import"./dropdown.esm-C3w7lM7_.js";import"./virtualscroller.esm-aVvJseNT.js";import"./csstransition.esm-BI2IUjb-.js";import"./overlayservice.esm-0R6tr4hB.js";import"./index.esm-BypTRDCm.js";import"./index.esm-Bh2Rs3JK.js";import"./index.esm-DSWsuiEf.js";import"./index.esm-D-5U2K2D.js";import"./TransitionGroup-_qrsneQI.js";import"./dialog.esm-BRb5edDq.js";import"./formik.esm-C2ZluvBh.js";function me({auth:s,usersAll:x,csrf_token:m,roles:f}){const[g,y]=a.useState(null),[j,p]=a.useState(!1),r=a.useRef(null),[b,u]=a.useState(!1),[v,h]=a.useState(!1),[c,d]=a.useState(x),T=e.jsx(e.Fragment,{children:e.jsx(L,{start:()=>e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:"pi pi-user-plus",className:"mr-2",tooltip:"Yeni Kullanıcı Ekle",tooltipOptions:{position:"top"},onClick:()=>{u(!0)},severity:"success"}),e.jsx(n,{icon:"pi pi-refresh",severity:"info",tooltip:"Verileri Yenile",tooltipOptions:{position:"top"},onClick:()=>{p(!0),P.visit(route("users.index"))}})]})})});return e.jsxs(S,{user:s.user,header:"Kullanıcı Yönetimi",info:[{text:`Toplamda ${c.length} Kullanıcı Var`,icon:"pi-users"}],buttons:[{icon:"pi pi-user-plus",tooltip:"Yeni Kullanıcı Ekle",severity:"success",tooltipOptions:{position:"bottom"},size:"small",onClick:()=>{u(!0)}}],children:[e.jsx(k,{title:"Kullanıcılar"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx(M,{ref:r}),e.jsxs(N,{value:c,removableSort:!0,paginator:!0,filterDisplay:"row",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",filters:{global:{value:null,matchMode:o.CONTAINS},name:{value:null,matchMode:o.CONTAINS},email:{value:null,matchMode:o.CONTAINS},"role.label":{value:null,matchMode:o.CONTAINS}},loading:j,globalFilterFields:["name","email","role"],header:T,emptyMessage:"Kullanıcı bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",children:[e.jsx(i,{field:"id",sortable:!0,header:"#"}),e.jsx(i,{filter:!0,showFilterMenu:!1,filterPlaceholder:"İsime Göre",field:"name",sortable:!0,header:"Adı"}),e.jsx(i,{filter:!0,showFilterMenu:!1,filterPlaceholder:"E-mail'e Göre",field:"email",sortable:!0,header:"Email"}),e.jsx(i,{filter:!0,showFilterMenu:!1,filterPlaceholder:"Role Göre",field:"role.label",sortable:!0,header:"Rol",body:({role:t})=>e.jsx(K,{value:t.label,severity:t.severity})}),e.jsx(i,{field:"created_at",sortable:!0,header:"Eklenme Tarihi",filter:!0,showFilterMenu:!1,filterPlaceholder:"Eklenme Tarihine Göre",body:t=>new Date(t.created_at).toLocaleString()}),e.jsx(i,{field:"updated_at",sortable:!0,header:"Güncellenme Tarihi",filter:!0,showFilterMenu:!1,filterPlaceholder:"Güncelleme Tarihine Göre",body:t=>new Date(t.updated_at).toLocaleString()}),e.jsx(i,{header:"İşlemler",body:t=>e.jsxs("div",{className:"flex justify-center gap-x-2",children:[e.jsx(n,{icon:"pi pi-pencil",size:"small",tooltip:"Kullanıcıyı Düzenle",tooltipOptions:{position:"top"},severity:"warning",onClick:()=>{if(t.role.role==="engineer"&&(s.user.role==="admin"||s.user.role==="salesman"||s.user.role==="worker")){r.current.show({severity:"info",summary:"Hata",detail:"Yetkiniz Yok!"});return}y(t),h(!0)}}),e.jsx(n,{icon:"pi pi-trash",size:"small",tooltip:"Kullanıcıyı Sil",tooltipOptions:{position:"top"},onClick:w=>{E({target:w.currentTarget,message:"Kullanıcıyı silmek istediğinize emin misiniz?",icon:"pi pi-exclamation-triangle",acceptClassName:"p-button-danger",accept:()=>{p(!0),fetch(route("users.destroy",t.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":m}}).then(l=>l.json()).then(l=>{l.status?(r.current.show({severity:"success",summary:"Başarılı",detail:l.message}),setTimeout(()=>{d(c.filter(C=>C.id!==t.id))},1e3)):r.current.show({severity:"error",summary:"Hata",detail:l.message})}).catch(l=>{r.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{p(!1)})},acceptLabel:"Sil",rejectLabel:"İptal"})},severity:"danger"})]})})]})]}),e.jsx(O,{auth:s,csrf_token:m,toast:r,visible:b,onChange:t=>{d(t)},setVisible:u,roles:f}),e.jsx(R,{user:g,auth:s,csrf_token:m,toast:r,visible:v,onChange:t=>{d(t)},setVisible:h,roles:f})]})})})]})}export{me as default};
