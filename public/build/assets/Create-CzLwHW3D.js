import{r as m,j as e}from"./app-CZojdjD4.js";import{I as A}from"./inputtextarea.esm-oIyypEZZ.js";import{I as h}from"./inputtext.esm-Bc9dGI99.js";import{D as f}from"./dropdown.esm-C3w7lM7_.js";import{B as C}from"./blockui.esm-CT455C9i.js";import{u as k}from"./formik.esm-C2ZluvBh.js";import{c as B,a as r,M as F,I as D}from"./inputmask.esm-Dc-Zujvi.js";import"./iconbase.esm-DvODm2qg.js";import"./virtualscroller.esm-aVvJseNT.js";import"./ripple.esm-ByfALGiA.js";import"./csstransition.esm-BI2IUjb-.js";import"./overlayservice.esm-0R6tr4hB.js";import"./index.esm-BypTRDCm.js";import"./index.esm-D-5U2K2D.js";const M={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API_KEY:"AIzaSyCN7BvJ97NkR-19ukoDEQxhIExBFdWhU0Y",VITE_APP_APP_ID:"1:255523054947:web:2b3010f8b99138f2199f56",VITE_APP_AUTH_DOMAIN:"erp-for-vuca.firebaseapp.com",VITE_APP_CITY_DISTRICT_URL:"https://raw.githubusercontent.com/snrylmz/il-ilce-json/master/js/il-ilce.json",VITE_APP_MESSAGING_SENDER_ID:"255523054947",VITE_APP_NAME:"ERP FOR VUCA",VITE_APP_PROJECT_ID:"erp-for-vuca",VITE_APP_STORAGE_BUCKET:"erp-for-vuca.firebasestorage.app",VITE_APP_VAPID_KEY:"BCHWmZ7t4B5F732KQaCTZR4K9VS9Sk1i6AziqjasmcB6-JVvCDHquvR6kdJH9z-UPtnTCzt2eP4kHpuQeuk4r6U"};function W({csrf_token:x,toast:l,onHide:_,setUsers:b,formRef:j,formSubmitted:y,onSave:I=()=>{}}){var p;const{VITE_APP_CITY_DISTRICT_URL:g}=M,[N,d]=m.useState(!1),[E,c]=m.useState([]),P=()=>{fetch(g).then(s=>s.json()).then(({data:s})=>{c(s)}).catch(s=>{c([])})};m.useEffect(()=>{P()},[]);const{values:i,handleSubmit:T,handleChange:n,setFieldValue:o,errors:u,setErrors:R}=k({initialValues:{name:"",email:"",phone:"",city:null,district:null,address:""},validationSchema:B().shape({name:r().required("Müşteri Adı Zorunludur"),email:r().email("Geçerli Bir E-Posta Adresi Giriniz"),phone:r().required("Telefon Numarası Zorunludur"),address:r().required("Adres Zorunludur")}),onSubmit:s=>{d(!0);let a=new FormData;a.append("name",s.name),a.append("email",s.email),a.append("phone",s.phone),a.append("city",s.city.il_adi),a.append("district",s.district.ilce_adi),a.append("address",s.address),fetch(route("customers.store"),{method:"POST",headers:{"X-CSRF-TOKEN":x},body:a}).then(t=>t.json()).then(t=>{if(t.status){l.current.show({severity:"success",summary:"Başarılı",detail:t.message});let S=t.user_id;I(!0,t.customers.find(v=>v.id===S)),b(t.customers),setTimeout(()=>{_()},500)}else l.current.show({severity:"error",summary:"Hata",detail:t.message})}).catch(t=>{l.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{setTimeout(()=>{d(!1)},500)})}});return e.jsx(C,{blocked:N,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsxs("form",{className:"p-fluid",onSubmit:T,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-2 mb-3",children:[e.jsx("div",{className:"col-span-2 grid gap-y-2",children:y&&Object.keys(u).length>0&&e.jsx(e.Fragment,{children:Object.entries(u).map(([s,a])=>e.jsx(F,{severity:"warn",text:a},s))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Müşteri Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(h,{id:"name",name:"name",onChange:n,value:i.name,autoFocus:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Müşteri E-Posta Adresi ",e.jsxs("span",{className:"font-semibold text-yellow-400",children:["*",e.jsx("sub",{children:"Boş Bırakılması Halinde Otomatik Doldurulacaktır"})]})]}),e.jsx(h,{id:"email",type:"email",name:"email",onChange:n,value:i.email})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Müşteri Telefon No ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(D,{id:"phone",type:"tel",mask:"0599 999 99 99",onChange:s=>o("phone",s.target.value),value:i.phone})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"city",className:"font-bold",children:["Müşteri Şehir ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(f,{value:i.city,onChange:s=>o("city",s.value),options:E,optionLabel:"il_adi",inputId:"city",itemTemplate:s=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-5 h-5 rounded inline-flex items-center justify-center bg-blue-700 text-white text-sm",children:s.plaka_kodu})," ",s.il_adi]}),placeholder:"Şehir Seçiniz",className:"w-full md:w-14rem",checkmark:!0,highlightOnSelect:!1,filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"Şehir Bulunamadı",emptyFilterMessage:"Şehir Bulunamadı",filterBy:"il_adi"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"district",className:"font-bold",children:["Müşteri İlçe ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(f,{value:i.district,inputId:"district",disabled:i.city===null,onChange:s=>o("district",s.value),options:(p=i.city)==null?void 0:p.ilceler,optionLabel:"ilce_adi",placeholder:"İlçe Seçiniz",className:"w-full md:w-14rem",checkmark:!0,highlightOnSelect:!1,filter:!0,virtualScrollerOptions:{itemSize:38},emptyMessage:"İlçe Bulunamadı",emptyFilterMessage:"İlçe Bulunamadı",filterBy:"ilce_adi"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"address",className:"font-bold",children:["Müşteri Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(A,{id:"address",name:"address",onChange:n,value:i.address})]}),e.jsx("button",{type:"submit",style:{display:"none"},ref:j})]})})}export{W as default};
